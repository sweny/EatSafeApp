var mysql = require("mysql");
var connection = mysql.createConnection({
	host	:'localhost',
	user	:'root',
	password:'root',
	database:'eatsafeapp',
	port : 3306
});
connection.connect();

exports.login = function(email,password,callback) {	
	connection.beginTransaction(function(err) {
		if (err) { 
			throw err; 
		}

		var sql    = 'SELECT password FROM users WHERE username = ' + connection.escape(email);
		connection.query(sql, function(err, results) {
			if (err) {
				console.log(err);
				connection.rollback(function() {
					throw err;
				}); 
			}
			console.log("results : "+results);
			if (results.length == 0) {
				callback({'response':"User doesnot exist",'res':false});
			} else {
				console.log("pass from db = "+results[0].password+" password entered = "+password);
				if (results[0].password == password) {
					callback({'response':"Success",'res':true});
				} else {
					callback({'response':"Invalid Password",'res':false});
				}
			}
		});
	});
}